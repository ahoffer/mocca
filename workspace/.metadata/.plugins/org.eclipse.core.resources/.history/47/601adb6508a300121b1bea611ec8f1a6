package weka.subspaceClusterer;

import java.io.FileWriter;
import java.io.IOException;
import java.util.ArrayList;
import java.util.Collection;
import java.util.List;
import java.util.NavigableSet;
import java.util.TreeMap;

import org.supercsv.io.CsvListWriter;
import org.supercsv.prefs.CsvPreference;

public class ResultsWriter {
    static String clustererExpKey = "EXP";
    static String clustererNameKey = "ALGO";
    static String dataNameKey = "ALGO";

    String path;

    /* The name of a measure or parameter (key) and either the measurement or the value of the parameter */
    TreeMap<String, Double> output = new TreeMap<String, String>();

    public void put(String name, Double value) {
        output.put(name, String.format("%f", value));
    }

    public void setPath(String path) {
        this.path = path;
    }

    public void write() {
        try {
            writeResults();
            writeClusters();
        } catch (Exception e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }

    }

    public void writeResults() throws Exception {

        CsvListWriter writer = getListWriter("RSLT");
        String[] header = output.navigableKeySet().toArray(new String[0]);

        writer.writeHeader(header.toArray(new String[0]));

        Collection<Double> values = output.values();
        values.addAll(output.values());
        List<String> stringVals = new ArrayList<>();
        for (Double each : values) {
            stringVals.add(String.format("%f", each));
        }
        writer.write(stringVals);
    }

    public void writeClusters() {
        // CsvListWriter writer = getListWriter("CLSTR");

    }

    String getQualifiedName(String name) {
        return primaryKey + path + "_" + name;
    }

    CsvListWriter getListWriter(String name) {

        String fqName = getQualifiedName(name);
        CsvListWriter temp = null;
        try {
            temp = new CsvListWriter(new FileWriter(fqName), new CsvPreference.Builder('"', ',', "\n").build());
        } catch (IOException e) {
            e.printStackTrace();
        }
        return temp;
    }

    public void setKey(String key) {
        output.put(clustererExpKey, key);
    }

    public void setClustererName(String name) {
        output.put(clustererNameKey, name);
    }

    public void setDataName(String name) {
        output.put(dataNameKey, name);
    }
}// class

